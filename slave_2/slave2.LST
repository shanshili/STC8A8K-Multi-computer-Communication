C51 COMPILER V9.00   SLAVE2                                                                12/02/2021 20:53:39 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE SLAVE2
OBJECT MODULE PLACED IN slave2.OBJ
COMPILER INVOKED BY: E:\keil\C51\BIN\C51.EXE slave2.c BROWSE DEBUG OBJECTEXTEND TABS(2)

line level    source

   1          #include "8A8K.h"
   2          #include "delay.h"
   3          #include "intrins.h"
   4          #define rxINTtestled P17
   5          #define LEDPLAY P2
   6          
   7          unsigned char dataa,led,flow;
   8          /*
   9          ‰∏≠Êñ≠xË∞ÉÁî®‰∏≤Âè£Êé•Êî∂Êï∞ÊçÆ
  10          P2ÊòæÁ§∫Êï∞ÊçÆ
  11          slave2 Âú∞ÂùÄ 0x02
  12          ‰ªéÊú∫2ÂÆåÊàêÊµÅÊ∞¥ÁÅØ
  13          */
  14          
  15          unsigned char seg[] = {0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90};
  16          
  17          //Êé•Êî∂ÊµãËØïÊï∞Á†ÅÁÆ°ÊòæÁ§∫
  18          void datatest()
  19          {
  20   1          dataa = SBUF;
  21   1          switch(dataa)
  22   1          {
  23   2            case(0x01): //Âæ™ÁéØÂè≥Áßª
  24   2                led = 0x01;
  25   2                while(1)
  26   2                {
  27   3                    led = _cror_(led,1);
  28   3                    LEDPLAY = led ;
  29   3                    Delay500ms();
  30   3                }
  31   2            case(0x02)://Âæ™ÁéØÂ∑¶Áßª
  32   2                led = 0x01;
  33   2                while(1)
  34   2                {
  35   3                    led = _crol_(led,1);
  36   3                    LEDPLAY = led ;
  37   3                    Delay500ms();
  38   3                }
  39   2            case(0x03)://1100 1100
  40   2            while(1)
  41   2            {
  42   3                LEDPLAY = 0xcc;
  43   3                Delay500ms();
  44   3                LEDPLAY = 0X33;
  45   3                Delay500ms();
  46   3            }
  47   2            case(0x04):  //1010 1010
  48   2            while(1)
  49   2            {
  50   3                LEDPLAY = 0x55;
  51   3                Delay500ms();
  52   3                LEDPLAY = 0XAA;
  53   3                Delay500ms();
  54   3            }
  55   2            case(0x05): //ÁÄëÂ∏É
C51 COMPILER V9.00   SLAVE2                                                                12/02/2021 20:53:39 PAGE 2   

  56   2            while(1)
  57   2            {
  58   3                led = 0x01;
  59   3                for(flow=0;flow<9;flow++)
  60   3                {
  61   4                  led = led + (2*flow);
  62   4                  LEDPLAY = led;
  63   4                  Delay10ms();Delay10ms();Delay10ms();Delay10ms();Delay10ms();Delay10ms();
  64   4                }
  65   3            }
  66   2            case(0x06):
  67   2            while(1)
  68   2            {  
  69   3                LEDPLAY = 0x00;
  70   3                Delay500ms();
  71   3                Delay500ms();
  72   3            }
  73   2            default:LEDPLAY = 0X00;Delay500ms();
  74   2          }
  75   1          P2 = dataa;
  76   1      }
  77          //‰∏≤Âè£‰∏Ä‰∏≠Êñ≠Ôºö‰∏éÂú∞ÂùÄÁõ∏ÂåπÈÖçÁöÑÊï∞ÊçÆÊù•ÂêéËøõÂÖ•‰∏≠Êñ≠
  78          void UART1()interrupt 4 using 1
  79          //void UART1() __interrupt (4) __using (1) //‰∏≤Âè£1‰∏≠Êñ≠ÊúçÂä°ÂáΩÊï∞//Ëß¶ÂèëÊù°‰ª∂ÔºöÂú∞ÂùÄÊï∞ÊçÆÔºå‰∏îÂ
             -ú∞ÂùÄÁõ∏ÂåπÈÖçÔºàÊ≠§Êó∂Â∑≤Â∞ÜRIÁΩÆ1Ôºâ
  80          {
  81   1          ES = 0; //ÂÖ≥Èó≠‰∏≤Âè£1‰∏≠Êñ≠
  82   1          RI = 0; //‰∏çÊ∏ÖÈõ∂ÁöÑËØùËÉΩÂê¶ÁªßÁª≠Êé•Êî∂ÔºüÔºü
  83   1        //-------ËøîÂõûÂìçÂ∫î
  84   1          SBUF = SADDR+0x01 ;
  85   1          while(!TI);
  86   1          TI = 0;
  87   1        //--------
  88   1          rxINTtestled = 1; //Ë°®Á§∫Â∑≤ÂáÜÂ§áÂ•ΩÊé•ÂèóÊï∞ÊçÆ
  89   1          SM2 = 0;//Êé•Êî∂Êï∞ÊçÆ
  90   1          Delay10ms();
  91   1      
  92   1          while(!RI); //Êé•Êî∂ÂÆåÊï∞ÊçÆ
  93   1          rxINTtestled = 0;
  94   1          RI = 0; //Ê∏ÖÈô§Êé•Êî∂Ê†áÂøó‰Ωç
  95   1          ES = 1; //ÈáçÊñ∞ÂºÄÂêØ‰∏≤Âè£1‰∏≠Êñ≠
  96   1          SM2 = 1;//Êé•Êî∂Êï∞ÊçÆ
  97   1          datatest(); //ÂÜÖÊúâÊ≠ªÂæ™ÁéØÔºåÊú™ÊâìÂºÄ‰∏≤Âè£ÔºåÊó†Ê≥ïÂÜçÊ¨°ËøõÂÖ•
  98   1      }
  99          
 100          //slave‰∏≤Âè£ËÆæÁΩÆ
 101          void UartInit(void)   //9600bps@24.000MHz
 102          {
 103   1          P3M1 = 0X01;     //ËÆæÁΩÆ‰∏∫È´òÈòª
 104   1          P3M0 = 0X02;
 105   1          P_SW1 = 0X00;    //Á´ØÂè£Êò†Â∞Ñ3.0 3.1
 106   1          SCON = 0xF0;    //‰∏≤Âè£ÊéßÂà∂Ôºö‰∏≤Âè£1Ôºå9‰ΩçÊï∞ÊçÆ,ÂèØÂèòÊ≥¢ÁâπÁéá  1111 0000 ÂÖÅËÆ∏‰∏≤Âè£Êé•Êî∂Êï∞Êç
             -ÆÔºåÁ≠õÈÄâÂú∞ÂùÄÂ∏ß,RB8=1‰∏∫Âú∞ÂùÄÂ∏ßÔºåÂú∞ÂùÄ‰ø°ÊÅØÂèØ‰ª•ËøõÂÖ•SBUFÂπ∂‰ΩøRI‰∏∫1ÔºåËøõËÄåÂú®‰∏≠Êñ≠ÊúçÂä°Á®ãÂ∫è‰∏≠ÂÜçËøõË
             -°åÂú∞ÂùÄÂè∑ÊØîËæÉÔºõ
 107   1          PCON &= 0x7F;   //ÁîµÊ∫êÁÆ°ÁêÜÔºöÊ≥¢ÁâπÁéá‰∏çÂÄçÈÄü PCON=0X00 SMOD=0
 108   1          AUXR &= 0xFE;   //ÈÄâÊã©Ê≥¢ÁâπÁéáÂèëÁîüÂô®ÔºöÂÆöÊó∂Âô®1
 109   1          AUXR |= 0x40;   //ÂÆöÊó∂Âô®1Êó∂ÈíüÔºöFosc,Âç≥1T T1x12=1
 110   1          TMOD &= 0x0F;   //ÂÆöÊó∂Âô®1Ê®°ÂºèÈÖçÁΩÆÔºöÂÆöÊó∂Ôºå16‰ΩçËá™Âä®ÈáçË£ÖÊñπÂºè
 111   1          TL1 = 0x8F;   //ËÆæÂÆöÂÆöÊó∂‰ΩéÂ≠óËäÇ: 
 112   1          TH1 = 0xFD;   //ËÆæÂÆöÂÆöÊó∂È´òÂ≠óËäÇ:  64911 65536-(SYSCLK/4/baud)
 113   1          ET1 = 0;    //ÂÆöÊó∂Âô®1‰∏≠Êñ≠ÔºöÁ¶ÅÊ≠¢
 114   1          ES = 1;         //‰∏≤Âè£1‰∏≠Êñ≠: ÂºÄÂêØ
C51 COMPILER V9.00   SLAVE2                                                                12/02/2021 20:53:39 PAGE 3   

 115   1          TR1 = 1;        //ÂêØÂä®ÂÆöÊó∂Âô®1
 116   1          EA = 1;         //‰∏≠Êñ≠ ÊÄªÂºÄÂÖ≥
 117   1          TR1 = 1;    //ÂêØÂä®ÂÆöÊó∂Âô®1
 118   1      }
 119          
 120          void main()
 121          {
 122   1          P2M0=0X00;
 123   1          P2M1=0X00;
 124   1          UartInit();
 125   1          SADDR = 0X02;
 126   1          SADEN = 0X0F;
 127   1          rxINTtestled = 0;
 128   1          while (1); 
 129   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    289    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     13    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
